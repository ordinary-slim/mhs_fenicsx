dim : 2
domain_width : 2
domain_height : 0.5
substrate_height : 1.0
adim_pad_width : 5.0
els_per_radius: 4
substrate_els_per_radius : 0.5
moving_els_per_radius : 8
num_layers : 2
num_buffer_layers : 4
interlayer_dwelling_time : 2.0
interlayer_recoating_time : 1.0
# BEG_ESSENTIAL
isSteady: False
radius : &radius 0.1
half_radius : &half_radius 0.05
source_terms :
  - initial_position : &p0 [-5.0, 0.0, 0.0]
    initial_speed : &speed [500.0, 0.0, 0]
    radius : *radius
    power : &power 900
    path: &path "Path.gcode"
  - type : lumped
    initial_position : *p0
    initial_speed : *speed
    radius : *radius
    power : *power
    mdwidth  : *radius
    mdheight : *half_radius
    mddepth : *half_radius
    path : *path
# PROPS
material_powder : {
  density : &density 4.3E-06, # kg / mm3
  conductivity :  [[25, 1.0E-03], [1625, 10.0E-03]], # W / mm / K
  specific_heat : &specific_heat 700, # J / kg / K
  phase_change : {
    latent_heat : &latent_heat 350.0E+03,
    solidus_temperature : &solidus_temperature 1600.0,
    liquidus_temperature : &liquidus_temperature 1650.0,
    melts_to : "metal",
  }
}
material_metal : {
  density : *density, # kg / mm3
  conductivity : 10.0E-03, # W / mm / K
  specific_heat : *specific_heat, # J / kg / K
  phase_change : {
    latent_heat : *latent_heat,
    solidus_temperature : *solidus_temperature,
    liquidus_temperature : *liquidus_temperature,
  }
}
convection_coeff : 0.1
radiation_coeff: 1.0E-10
smoothing_cte_phase_change : 0.5
environment_temperature : &environment_temperature 25
# END_ESSENTIAL
petsc_opts_micro: {
  "ksp_error_if_not_converged" : "true",
  "ksp_type" : "gmres",
  "ksp_atol" : 1e-13,
  "ksp_rtol" : 1e-13,
  "pc_type" : "jacobi",
}
petsc_opts_macro: {
  "ksp_error_if_not_converged" : "true",
  "ksp_type" : "gmres",
  "ksp_atol" : 1e-10,
  "ksp_rtol" : 1e-10,
  "pc_type" : "hypre",
  "snes_linesearch_type" : "basic",
  "snes_rtol" : 1e-8,
  "snes_atol" : 1e-8,
}
petsc_opts_mono_robin: {
  "ksp_error_if_not_converged" : "true",
  "ksp_type" : "gmres",
  "ksp_atol" : 1e-13,
  "ksp_rtol" : 1e-13,
  "pc_type" : "fieldsplit",
}
petsc_opts_macro_chimera: {
  "ksp_error_if_not_converged" : "true",
  "ksp_type" : "gmres",
  "ksp_atol" : 1e-13,
  "ksp_rtol" : 1e-13,
  "pc_type" : "fieldsplit",
}

max_timesteps: -1
dt : 1.0 #placeholder

driver_type: "robin"
initial_condition: False
quadrature_metadata: {}
supg: 1

max_nr_iters: 30
max_ls_iters: 5

printer: {
  type : 'LPBF',
  reuse_heated_els : False,
  layer_thickness : 0.05,
  deposition_temperature : *environment_temperature
}

substepping_parameters: {
  micro_adim_dt: 0.5,
  macro_adim_dt: 5.0,
  cooling_adim_dt: 0.5,
  dwelling_adim_dt: 0.5,
  max_staggered_iters: 1,
  predictor: {
    enabled :  True,
    source_term : 1,
  },
  writepos: True,
  skip_predictor_writepos: True,
  post_type: "vtx",
  chimera_always_on: False,
  chimera_driver: {
    type: "monolithic",
    gamma_coeff1 : 1.0,
    gamma_coeff2 : 1.0,
  },
  chimera_steadiness_workflow: {
    enabled: False,
  },
}

moving_domain_params : {
  shape : True,
  max_adim_dt : 2,
  adim_front_len : 2,
  adim_side_len : 2,
  adim_bot_len : 2,
  adim_top_len : 2,
}
gamma_quadrature: {
  degree: 2,
}
